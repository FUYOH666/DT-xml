# Обязательные поля для поиска

## Приоритеты полей

Система использует трехуровневую систему приоритетов для определения важности полей:

### P0 - Обязательные поля (критичные для работы системы)

Эти поля **обязательны** для всех деклараций и необходимы для базовой функциональности:

- **`declaration_number`** - Номер декларации
  - Использование: Уникальная идентификация декларации
  - Формат: Строка
  - Пример: "12345", "ДТ-2023-001234"

- **`date_issued`** - Дата выпуска декларации
  - Использование: Временная фильтрация, сортировка
  - Формат: YYYY-MM-DD или ISO 8601
  - Пример: "2023-06-15"

- **`declaration_type`** - Тип декларации
  - Использование: Базовая категоризация
  - Формат: Строка (import/export/transit)
  - Пример: "import"

**Без этих полей система не сможет корректно обработать декларацию.**

### P1 - Критичные для поиска (рекомендуемые)

Эти поля **сильно улучшают качество поиска** и должны быть предоставлены для оптимальной работы:

- **`manufacturer`** - Производитель товара
  - Использование: Основной критерий поиска, фильтрация
  - Формат: Строка
  - Пример: "Samsung Electronics", "Apple Inc."
  - **Влияние на поиск**: Высокое (boost: 2.0)

- **`product_code`** - Код товара (ТН ВЭД)
  - Использование: Точный поиск по коду, фильтрация
  - Формат: 10 цифр
  - Пример: "8517120000"
  - **Влияние на поиск**: Высокое (boost: 1.5)

- **`product_description`** - Описание товара
  - Использование: Семантический поиск, embedding
  - Формат: Текст
  - Пример: "Смартфоны с поддержкой 5G"
  - **Влияние на поиск**: Среднее (boost: 1.2)

- **`full_text`** - Полный текст декларации
  - Использование: Семантический поиск, embedding
  - Формат: Текст
  - **Влияние на поиск**: Высокое (для семантического поиска)

**Без этих полей поиск будет работать, но с ограниченной точностью.**

### P2 - Желательные поля (опциональные)

Эти поля улучшают функциональность, но не критичны:

- **`importer`** / **`exporter`** - Импортер/Экспортер
  - Использование: Фильтрация по компаниям
  - Формат: Строка

- **`country_origin`** - Страна происхождения
  - Использование: Фильтрация по стране
  - Формат: ISO код страны (2 символа)
  - Пример: "CN", "RU", "DE"

- **`customs_value`** - Таможенная стоимость
  - Использование: Числовые фильтры, аналитика
  - Формат: Число

- **`currency`** - Валюта
  - Использование: Фильтрация, нормализация
  - Формат: ISO код валюты (3 символа)
  - Пример: "USD", "EUR", "RUB"

- **`quantity`** - Количество
  - Использование: Числовые фильтры
  - Формат: Число

- **`unit_of_measure`** - Единица измерения
  - Использование: Контекст для количества
  - Формат: Строка
  - Пример: "шт", "кг", "м³"

## Минимальные требования для эффективного поиска

Для обеспечения эффективного поиска рекомендуется предоставить минимум:

1. **Все поля P0** (обязательны)
2. **Все поля P1** (критичны для поиска)

Итого минимум 6 полей:
- declaration_number
- date_issued
- declaration_type
- manufacturer
- product_code
- product_description

## Формат предоставления данных

### Предпочтительный формат (JSON)

```json
{
  "declaration_number": "12345",
  "date_issued": "2023-06-15",
  "declaration_type": "import",
  "manufacturer": "Samsung Electronics",
  "product_code": "8517120000",
  "product_description": "Смартфоны с поддержкой 5G",
  "full_text": "Полный текст декларации..."
}
```

### Альтернативный формат (XML)

```xml
<declaration>
  <declaration_number>12345</declaration_number>
  <date_issued>2023-06-15</date_issued>
  <declaration_type>import</declaration_type>
  <manufacturer>Samsung Electronics</manufacturer>
  <product_code>8517120000</product_code>
  <product_description>Смартфоны с поддержкой 5G</product_description>
</declaration>
```

### OCR формат (fallback)

Если данные предоставляются в виде OCR результата (неструктурированный текст), система попытается извлечь поля автоматически, но качество будет зависеть от структуры текста.

## Валидация

Система автоматически валидирует наличие обязательных полей (P0) при индексации. Если поля отсутствуют, будет выдано предупреждение, но декларация может быть обработана с ограниченной функциональностью.

## Рекомендации для заказчиков

1. **Всегда предоставляйте поля P0** - без них система не сможет корректно идентифицировать декларацию
2. **Предоставляйте поля P1** для оптимального качества поиска
3. **Используйте стандартизированные форматы** (ISO коды для стран и валют, формат дат)
4. **Нормализуйте названия компаний** для лучшего поиска
5. **Предоставляйте полный текст** (`full_text`) для семантического поиска
